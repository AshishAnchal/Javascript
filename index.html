<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Quiz App</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(120deg, #89f7fe, #66a6ff);
      margin: 0;
      padding: 20px;
      color: #333;
    }

    h1 {
      text-align: center;
      color: #fff;
      margin-bottom: 30px;
      font-size: 36px;
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.2);
    }

    input[type="text"] {
      padding: 12px;
      border: 2px solid #66a6ff;
      border-radius: 12px;
      width: 280px;
      font-size: 16px;
      outline: none;
      transition: 0.3s;
      margin-top: 10px;
    }

    input[type="text"]:focus {
      border-color: #4e9dff;
      box-shadow: 0 0 10px rgba(78, 157, 255, 0.7);
    }

    button {
      padding: 12px 24px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(45deg, #4facfe, #00f2fe);
      color: white;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 15px;
    }

    button:hover {
      background: linear-gradient(45deg, #00f2fe, #4facfe);
      transform: scale(1.08);
      box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.2);
    }

    #quizdiv {
      background: white;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      max-width: 600px;
      margin: 20px auto;
      text-align: left;
      animation: fadeIn 0.6s ease-in-out;
    }

    #quizdiv h2 {
      margin-bottom: 15px;
      color: #4facfe;
    }

    #quizdiv p {
      font-size: 18px;
      margin-bottom: 15px;
    }

    #quizdiv label {
      display: block;
      margin: 10px 0;
      font-size: 16px;
      padding: 10px;
      border-radius: 10px;
      transition: background 0.3s;
      cursor: pointer;
    }

    #quizdiv input[type="radio"] {
      margin-right: 10px;
    }

    #quizdiv label:hover {
      background: #f4faff;
    }

    #pscore {
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      margin-top: 25px;
      padding: 15px;
      border-radius: 15px;
      background: white;
      display: inline-block;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      color: #222;
    }

    table {
      border-collapse: collapse;
      margin: 20px auto;
      width: 90%;
      background: white;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      animation: fadeIn 0.6s ease-in-out;
    }

    th,
    td {
      padding: 12px;
      text-align: center;
      font-size: 15px;
      border-bottom: 1px solid #eee;
    }

    th {
      background: #4facfe;
      color: white;
    }

    tr:hover {
      background: #f1f9ff;
    }

    .correct {
      color: green;
      font-weight: bold;
    }

    .wrong {
      color: red;
      font-weight: bold;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
  <script>
    let username = "";
    let q = [];
    let p = [];
    let questions = [];
    let quesno = 0, score = 0;
    let userAnswers = [];

    function fetchlist() {
      return fetch('https://ashishanchal.github.io/Javascript/quizlist.json')
        .then(res => res.json())
        .then(data => {
          q = data;
          localStorage.setItem('q', JSON.stringify(q));
          return q;
        })
        .catch(err => console.error("Error fetching main list:", err));
    }

    function startlist() {
      username = document.getElementById("nameuser").value.trim();
      if (username === "") {
        alert("âš ï¸ Please enter your name before starting!");
        return;
      }

      fetchlist().then(() => {
        const stored = JSON.parse(localStorage.getItem("q") || "[]");
        let output = "<table><tr><th>Subject</th><th>Action</th></tr>";
        stored.forEach(item => {
          output += `<tr>
                        <td>${item.subject}</td>
                        <td><button onclick="getQuizzesForSubject('${item.url}')">View Quizzes</button></td>
                    </tr>`;
        });
        output += "</table>";
        document.getElementById("dquiz").innerHTML = output;
      });
    }

    function getQuizzesForSubject(url) {
      fetch(url)
        .then(res => res.json())
        .then(data => {
          p = data;
          localStorage.setItem('p', JSON.stringify(p));
          showSubjectQuizzes();
        })
        .catch(err => console.error("Error fetching subject quizzes:", err));
    }

    function showSubjectQuizzes() {
      const stored = JSON.parse(localStorage.getItem("p") || "[]");
      let output = "<table><tr><th>Quiz</th><th>Action</th></tr>";
      stored.forEach(item => {
        output += `<tr>
                    <td>${item.sub}</td>
                    <td><button onclick="getQuestions('${item.url}')">Start Quiz</button></td>
                </tr>`;
      });
      output += "</table>";
      document.getElementById("divquiz").innerHTML = output;
    }

    function getQuestions(url) {
      if (username.trim() === "") {
        alert("âš ï¸ Please enter your name before starting the quiz!");
        return;
      }

      fetch(url)
        .then(res => res.json())
        .then(data => {
          questions = data;
          localStorage.setItem('questions', JSON.stringify(questions));
          startQuiz();
        })
        .catch(err => console.error("Error fetching questions:", err));
    }

    function startQuiz() {
      quesno = 0;
      score = 0;
      userAnswers = [];

      document.body.innerHTML = `
        <div id="quizdiv">
          <h2 id="lblquesno"></h2>
          <p id="lblquestion"></p>
          <label><input type="radio" name="opt" id="rda"> <span id="lbla"></span></label>
          <label><input type="radio" name="opt" id="rdb"> <span id="lblb"></span></label>
          <label><input type="radio" name="opt" id="rdc"> <span id="lblc"></span></label>
          <label><input type="radio" name="opt" id="rdd"> <span id="lbld"></span></label>
          <input type="radio" name="opt" style="display:none" id="rde">
          <button onclick="nextQuestion()">Next</button>
        </div>
        <div style="text-align:center;">
          <p id="pscore">Score: 0</p>
        </div>
      `;
      showQuestion();
    }

    function showQuestion() {
      const q = questions[quesno];
      document.getElementById("rde").checked = true;
      document.getElementById("lblquesno").textContent = `Q${quesno + 1}:`;
      document.getElementById("lblquestion").textContent = q.question;
      document.getElementById("lbla").textContent = `A) ${q.a}`;
      document.getElementById("lblb").textContent = `B) ${q.b}`;
      document.getElementById("lblc").textContent = `C) ${q.c}`;
      document.getElementById("lbld").textContent = `D) ${q.d}`;
    }

    function getSelectedOption() {
      if (document.getElementById("rda").checked) return "a";
      if (document.getElementById("rdb").checked) return "b";
      if (document.getElementById("rdc").checked) return "c";
      if (document.getElementById("rdd").checked) return "d";
      return "e";
    }

    function nextQuestion() {
      let totalques = questions.length;
      const selected = getSelectedOption();
      const correctanswer = questions[quesno].correct_ans;

      if (selected === "e") {
        alert("âš ï¸ Please select an option.");
        return;
      }

      userAnswers.push({ question: questions[quesno].question, selected, correct: correctanswer, options: questions[quesno] });

      if (selected === correctanswer) {
        score++;
        document.getElementById("pscore").textContent = `Score: ${score}`;
      }
      quesno++;
      if (quesno >= totalques) {
        showResults();
        return;
      }
      showQuestion();
    }

    function showResults() {
      document.body.innerHTML = `
        <h1>Quiz Completed ðŸŽ‰</h1>
        <div style="text-align:center;">
          <p id="pscore">${username}, your final score is ${score}/${questions.length}</p>
        </div>
        <table>
          <tr>
            <th>Question</th>
            <th>Your Answer</th>
            <th>Correct Answer</th>
          </tr>
          ${userAnswers.map((ans, index) => {
        let userAnsText = ans.options[ans.selected] || "Not Answered";
        let correctAnsText = ans.options[ans.correct];
        let cssClass = ans.selected === ans.correct ? "correct" : "wrong";
        return `<tr>
                  <td>${index + 1}. ${ans.question}</td>
                  <td class="${cssClass}">${userAnsText}</td>
                  <td class="correct">${correctAnsText}</td>
                </tr>`;
      }).join("")}
        </table>
        <div style="text-align:center;">
          <button onclick="location.reload()">Restart Quiz</button>
        </div>
      `;
    }
  </script>
</head>

<body>
  <h1>QUIZ</h1>
  <div style="text-align:center;">
    <label for="nameuser" style="color:white;font-size:18px;">Enter your name:</label><br>
    <input id="nameuser" type="text" placeholder="Enter your name here"><br><br>
    <button onclick="startlist()">Start</button>
  </div>

  <center>
    <div id="dquiz"></div><br>
    <div id="divquiz"></div>
  </center>
</body>

</html>

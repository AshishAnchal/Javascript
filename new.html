<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Science Quiz</title>
</head>

<body>
    <h1>Science Quiz</h1>
    <div id="output"></div>
    <button id="qsci" onclick="fetchques()">Start</button>
    <br>
    <p id="pquestionno">QuestionNo.</p>
    <p id="pquestion">Question</p>

    <label><input type="radio" name="option" id="rda"><span id="opta">A</span></label><br>
    <label><input type="radio" name="option" id="rdb"><span id="optb">B</span></label><br>
    <label><input type="radio" name="option" id="rdc"><span id="optc">C</span></label><br>
    <label><input type="radio" name="option" id="rdd"><span id="optd">D</span></label><br>

    <div id="neww"></div>
    <button id="nextq" onclick="fetchnew()">Next</button>
    <button id="check" onclick="checkAnswer()">CheckAns</button>
    <div id="status"></div>

    <script>
        const statusdiv = document.getElementById("status");
        const rda = document.getElementById('rda');
        const rdb = document.getElementById('rdb');
        const rdc = document.getElementById('rdc');
        const rdd = document.getElementById('rdd');

        const opta = document.getElementById('opta');
        const optb = document.getElementById('optb');
        const optc = document.getElementById('optc');
        const optd = document.getElementById('optd');

        const pquestion = document.getElementById('pquestion');
        const pquestionno = document.getElementById('pquestionno');

        let ques_no = 1;
        let questions = [];

        function fetchques() {
            const url = "https://ashishanchal.github.io/Javascript/science.json";
            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`${response.status} - ${response.statusText}`);
                    }
                    return response.json();
                })
                .then(data => {
                    questions = data;
                    localStorage.setItem("first", JSON.stringify(data));
                    statusdiv.innerHTML = "Downloaded successfully";
                    fetchnew();
                })
                .catch(error => {
                    statusdiv.innerHTML = `Error: ${error.message}`;
                });
        }

        function fetchnew() {
            if (!questions.length) {
                questions = JSON.parse(localStorage.getItem("first") || "[]");
            }
            if (ques_no <= questions.length) {
                showques(ques_no);
                ques_no++;
            } else {
                statusdiv.innerHTML = "Quiz Completed!";
            }
        }

        function showques(qno) {
            const q = questions[qno - 1];
            pquestionno.textContent = `QuestionNo. ${qno}`;
            pquestion.textContent = q.question;
            opta.textContent = q.a;
            optb.textContent = q.b;
            optc.textContent = q.c;
            optd.textContent = q.d;

            // Uncheck all radio buttons
            rda.checked = rdb.checked = rdc.checked = rdd.checked = false;

            // Store correct answer for checking
            pquestion.dataset.correct = q.ans;
        }

        function checkAnswer() {
            const selected =
                rda.checked ? "a" :
                rdb.checked ? "b" :
                rdc.checked ? "c" :
                rdd.checked ? "d" : null;

            const correct = pquestion.dataset.correct;

            if (selected === null) {
                statusdiv.innerHTML = "Please select an answer!";
            } else if (selected === correct) {
                statusdiv.innerHTML = "✅ Correct!";
            } else {
                statusdiv.innerHTML = `❌ Wrong! Correct answer is ${correct.toUpperCase()}`;
            }
        }
    </script>
</body>

</html>
